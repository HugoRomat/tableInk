import {guid} from './../components/Helper';
import update from 'immutability-helper';
import { combineReducers } from 'redux';
import undoable, { distinctState } from 'redux-undo';
import { includeAction, excludeAction } from 'redux-undo';

// const initialState = { 
//     sketchLines: [],
//     groupLines: [],
//     stickyLines: [],
//     "menuItems": [],
//     "lettres": []
//   };

  // function populateLetters(){
  //   var alphabet = 'abcdefghijklmnopqrstuvwxyz'.split('');
  //   alphabet.forEach((d)=>{
  //     var data = {
  //       'lettre':d,
  //       'data': [], 
  //       'id': guid()
  //     }


  //     initialState.lettres.push(data);
  //   })
  // }

  // populateLetters();


// initialState.stickyLines = [{
//     "points":[[0,0],[1.5,5],[2,7.5],[2,9],[2,10.5],[2.5,12],[2.5,13.5],[2.5,15],[2.5,16.5],[2.5,18],[2.5,20],[2.5,21.5],[2.5,23],[2.5,25],[2,27],[2,29],[2,30.5],[2,32.5],[2,34],[1.5,36],[1.5,38],[1.5,44.5],[1.5,47.5],[1.5,50],[1.5,53],[1.5,55.5],[1.5,58.5],[1.5,61.5],[1.5,64.5],[1.5,67.5],[1.5,70.5],[1.5,73.5],[1.5,76.5],[1.5,79.5],[1.5,82.5],[1.5,85.5],[1.5,88.5],[1.5,91.5],[2,95],[2,100.5],[2,106.5],[2,112.5],[2,119],[2,125],[2.5,131.5],[2.5,134.5],[2.5,138],[2.5,141],[2.5,144],[3,149.5],[3,152.5],[3,155],[3.5,160.5],[4,165],[4,167],[4,169.5],[4.5,171.5],[4.5,173.5],[5,178],[5,180],[5,182],[5,184],[5,186],[5,190.5],[5,192.5],[5,195],[5,199.5],[5,201.5],[5,203.5],[5,205.5],[5,207.5],[5,209.5],[5,211.5],[4.5,215.5],[4.5,217.5],[4.5,219],[4.5,220.5],[4.5,222.5],[4.5,224],[4.5,225.5],[4.5,228],[4.5,229],[4.5,230.5],[4.5,232.5],[4.5,234.5],[4.5,235.5],[4.5,236.5],[4.5,237.5],[4,238.5],[4,239],[4,240],[4,240.5],[4.5,241.5]],
//     "linesAttached":[], 
//     'placeHolder': [{'id':'left', 'data': {}, 'lines':[]}, {'id':'right', 'data': {}, 'lines':[]}, {'id':'top', 'data': {}, 'lines':[]}, {'id':'bottom', 'data': {}, 'lines':[]}, {'id':'middle', 'data': {}, 'lines':[]}],
//     "id":"b3f0f2126ae6c25432125fa9db0b22867",
//     "position":[160,228],
//     'textPosition': {'where': 'right', 'position': [10,50]},
//   }
// ];


const initialState =
  {"sketchLines":[{"points":[[0,0],[1.5,-1.5],[2.5,-3.5],[3,-5],[6,-8.5],[7,-10],[9.5,-15],[11,-18.5],[12,-22.5],[12.5,-24.5],[13,-30.5],[13.5,-32.5],[13.5,-37.5],[13.5,-39],[13.5,-42.5],[13.5,-43],[13.5,-44.5],[13.5,-44],[13.5,-43.5],[13,-40],[12.5,-38.5],[11.5,-33],[11,-31],[9.5,-24.5],[9,-22],[7.5,-15.5],[7,-13],[6,-7],[5.5,-3.5],[5,-0.5],[5,1.5],[5,2.5],[5.5,3],[6,2.5],[6.5,2],[7,0],[7.5,-2],[8,-3.5],[9.5,-7],[10,-8.5],[11.5,-12],[12,-13],[13.5,-15.5],[14,-16],[15,-16.5],[15.5,-16.5],[16.5,-15.5],[16.5,-15],[17.5,-12.5],[17.5,-11.5],[18,-8],[18,-7],[19,-3],[19,-2],[20,0.5],[20.5,1.5],[22,3],[23,3],[25,3.5],[26,3.5],[28.5,2],[30,1.5],[32,-0.5],[33,-1.5],[34.5,-5],[35,-6],[36,-9.5],[36.5,-10.5],[37,-13.5],[37,-14.5],[36.5,-17],[36.5,-17.5],[36,-18.5],[35,-18.5],[34.5,-17],[33.5,-15.5],[33.5,-14],[32.5,-10],[32.5,-9],[32,-5],[32,-3.5],[32.5,0],[33,1],[34,2.5],[34.5,3],[36.5,3],[37,3],[39.5,1.5],[40,1],[43,-2],[46.5,-6.5],[50.5,-13],[51,-15],[53,-20.5],[53.5,-22.5],[54.5,-28],[55,-30],[55.5,-35.5],[55.5,-37],[55,-41],[55,-42.5],[54.5,-44.5],[54.5,-45],[54,-44],[53.5,-43.5],[52.5,-39.5],[52,-37.5],[51,-32],[50,-27.5],[49.5,-23],[49.5,-21],[49.5,-14.5],[49.5,-13],[50,-8],[50.5,-6.5],[52,-3.5],[52.5,-2.5],[54.5,-1],[55,-1],[57,-1],[58,-1.5],[60,-3.5],[61,-4.5],[63,-8],[64,-9.5],[66,-14],[66.5,-16],[68.5,-21.5],[69,-24],[70,-29.5],[70,-33.5],[70,-36.5],[70,-38],[69.5,-40.5],[69,-41.5],[69,-42.5],[68,-44],[67.5,-44],[66,-43],[65.5,-42],[64.5,-38.5],[64,-36.5],[63,-31.5],[62.5,-29],[62,-23],[62,-20.5],[62,-14],[62.5,-6],[64,0],[65,2],[66.5,3],[71,3],[75,0.5],[76,-0.5],[78,-3.5],[79.5,-6.5],[80.5,-9],[81,-10.5],[82,-14],[82.5,-15],[82.5,-16.5],[82.5,-14.5],[82.5,-13],[82.5,-10],[82,-7.5],[82,-5],[82,-2.5],[82.5,-0.5],[82.5,0.5],[83.5,2],[84,2.5],[85.5,3],[86,3],[88,2.5],[89,2],[91,0.5],[92,-0.5],[94,-3],[95,-4],[96.5,-7],[97,-8],[98,-11],[98,-12],[98,-15],[96.5,-18.5],[93,-21.5],[89,-23.5],[88,-24],[85,-23],[84.5,-22.5],[82,-20],[81.5,-19.5],[81,-16.5],[80.5,-15],[81,-12.5],[81.5,-11],[82.5,-10],[83,-9.5],[85.5,-9],[86.5,-9],[90,-10],[91.5,-10],[95.5,-12],[98,-13.5],[100.5,-15],[102,-16],[105,-18.5],[106,-19.5],[108.5,-21.5]],"data":{"class":[]},"id":"bdc339b4d75bd4eb504fb5bd41848d65e","position":[535,197.5]},{"points":[[0,0],[0,-0.5],[0.5,-1.5],[1,-1.5],[1,-2],[1.5,-2],[2,-1.5],[3,0],[3,1],[3,2],[3.5,4.5],[4,7],[4,9.5],[4,12],[3.5,15],[3.5,16],[2.5,19.5],[2,21],[1,24],[0,25.5],[-1,26.5],[-2,27],[-3.5,27],[-5.5,25.5],[-6,25],[-7,22],[-7,21],[-7,17.5],[-6,15.5],[-5,13.5],[-4,12],[-2.5,11],[-1.5,10.5],[0,10.5],[2,12.5],[4,16.5],[4,17.5],[5.5,20.5],[5.5,21.5],[6.5,24.5],[7.5,26.5],[8,26.5],[9.5,26.5],[9.5,26],[11,24.5],[11.5,23.5],[12.5,20.5],[13,19.5],[14,16],[14,15],[14.5,11],[14.5,10],[14.5,7],[15,6],[15,6.5],[15,7],[15,9.5],[15,11],[14.5,14.5],[14.5,16],[14,19.5],[14,20.5],[13.5,23.5],[13.5,24.5],[13,26.5],[13,27],[13,26],[13,25.5],[14,22.5],[14,21.5],[15,18],[16.5,13.5],[17.5,12],[19,10.5],[19.5,10],[21,9],[22.5,9],[22.5,9.5],[23.5,10.5],[24,11],[25,12.5],[25,13.5],[26,15],[26,15.5],[26,17.5],[26,18],[25.5,20],[25.5,20.5],[24.5,21.5],[24.5,22],[23,23],[22,23],[21.5,23.5],[21,23.5],[19,23.5],[16.5,23],[15.5,23.5],[15,25],[14.5,25],[14.5,27],[14.5,28],[14,30],[14,31],[14,33.5],[14,34.5],[14,38.5],[13.5,40],[13.5,45],[13,46.5],[13,48.5],[12.5,52.5],[12,56.5],[12,60],[11.5,62],[12,66],[12,67],[12,67.5]],"data":{"class":[]},"id":"b6e27100b539831835cf286acf79520c4","position":[547.5,275]},{"points":[[0,0],[0,-0.5],[0,0],[0,0.5],[0,1.5],[0,2],[0,3],[-0.5,5],[-0.5,5.5],[-0.5,6.5],[-0.5,7.5],[-1,8.5],[-1,11],[-1.5,12],[-1.5,12.5],[-1.5,14.5],[-1.5,15],[-2,16],[-2,16.5],[-2,17],[-1.5,16.5],[-1.5,16],[-1.5,15.5],[-1.5,15],[-1,13.5],[-1,13],[-1,12],[-1,11.5],[-1,10.5],[-1,9.5],[-0.5,9],[-0.5,7],[0,5.5],[0.5,5],[0.5,4.5],[1,3.5],[1.5,3],[2,2.5],[2.5,2],[3,2],[3.5,1.5],[4.5,1.5],[5,1.5],[5.5,1.5],[6,1.5],[6.5,1.5],[7,1.5],[7,2],[8,2],[8,2.5],[8.5,2.5],[8.5,3],[9,3.5],[9,4.5],[9.5,5],[9.5,5.5],[9.5,6],[9.5,6.5],[9.5,7.5],[9.5,8.5],[9.5,9.5],[9,10],[9,11],[8.5,12],[8,12.5],[7.5,13],[7,13.5],[6.5,14],[5.5,14.5],[4.5,15],[4,15],[3.5,15],[2.5,15.5],[1.5,15.5],[1,15.5],[0.5,15.5],[0,15.5],[-0.5,16],[-0.5,16.5],[-0.5,17.5],[-0.5,19],[-0.5,20],[-0.5,21.5],[0,22.5],[0,23],[0.5,25],[0.5,26],[1,27],[1,28],[1,29],[1.5,31.5],[1.5,33],[1.5,35],[1.5,38.5],[1,42],[0.5,46],[0,50],[0,52],[-0.5,56],[-0.5,57],[0,58.5]],"data":{"class":[]},"id":"b3dfc416126c970943796d92ebe46b862","position":[582.5,283.5]},{"points":[[0,0],[0.5,-0.5],[1,-1.5],[1.5,-2.5],[2.5,-3.5],[3,-5],[4,-6.5],[4.5,-7.5],[5,-9],[6,-11],[6.5,-13.5],[7,-14.5],[7.5,-16],[8,-18.5],[8.5,-20],[9,-21.5],[9.5,-24],[10,-26],[10,-27],[10.5,-28.5],[10.5,-29.5],[10.5,-32],[10.5,-33],[10.5,-34],[10.5,-36],[10,-37],[9.5,-38],[9,-38.5],[8.5,-39],[8,-39.5],[7,-39.5],[6,-39],[5,-38],[4.5,-36.5],[3.5,-35],[3,-34],[3,-32.5],[2.5,-30],[2,-27],[2,-23.5],[2,-20],[1.5,-16],[1.5,-14],[1.5,-12],[1,-7.5],[1,-2.5],[1,1.5],[1,3.5],[1,5],[1.5,8],[2,9.5],[3.5,12],[4.5,13],[5,13.5],[5.5,13.5],[7,13.5],[7.5,13.5],[8,13],[8.5,13],[9,12.5],[10,11.5],[11,10],[12,8],[12.5,7],[13.5,6],[14,4],[15,1.5],[15.5,0],[16,-1],[16.5,-3],[17,-5.5],[17.5,-7.5],[17.5,-9.5],[17.5,-10],[17.5,-10.5],[17,-12],[17,-12.5],[16.5,-13],[16,-13],[15,-12],[14.5,-10.5],[14,-9],[13.5,-7],[13,-5],[12.5,-2.5],[12.5,0],[13,1],[13,2.5],[13.5,4.5],[14,6.5],[14.5,8],[15.5,9.5],[16.5,11],[17.5,11.5],[19.5,12],[21,11.5],[23,11],[25,9.5],[27.5,8],[29,6],[30.5,4],[32,1.5],[32.5,0.5],[33.5,-2],[34,-4.5],[34.5,-6.5]],"data":{"class":[]},"id":"bfd41f34e463e6d47c17ab0c258268de1","position":[605.5,288.5]},{"points":[[0,0],[0,-0.5],[0,-1],[0,-1.5],[0,-2.5],[0,-3.5],[-0.5,-5],[-0.5,-6],[-1,-7],[-1,-7.5],[-1.5,-8],[-1.5,-8.5],[-2,-9],[-2,-9.5],[-2.5,-10],[-3,-10.5],[-3.5,-10.5],[-4.5,-10.5],[-5,-10],[-6,-9.5],[-7,-8],[-7.5,-6],[-8,-5],[-8.5,-4],[-9,-1.5],[-9.5,0],[-9.5,1.5],[-10,4.5],[-9.5,7.5],[-9.5,10.5],[-9,13.5],[-8.5,16],[-8.5,17],[-8,18],[-8,19],[-7.5,19.5],[-7,21],[-6,21.5],[-5.5,21.5],[-4.5,22],[-4,21.5],[-3,20.5],[-2.5,20],[-2,19.5],[-1,18.5],[-0.5,17.5],[0,16],[1,14.5],[1.5,12.5],[2,11],[2.5,9],[2.5,7],[3,5],[3.5,3.5],[3.5,2],[3.5,1],[3.5,0.5],[4,0.5],[4,0],[4,0.5],[4,1],[3.5,1.5],[3.5,2],[3.5,3.5],[3.5,4.5],[3.5,5.5],[3.5,6.5],[3.5,7.5],[3.5,9.5],[3.5,11.5],[3.5,12.5],[3.5,13.5],[3.5,15],[3.5,16],[4,17.5],[4,18.5],[4.5,19],[5,20],[6,21],[7,21],[8.5,21],[9.5,21],[10.5,20],[11.5,19.5],[12,19],[12.5,18],[13.5,16],[14,14.5],[14,13.5],[14.5,12.5],[14.5,10.5],[14.5,8.5],[14.5,6.5],[14.5,5],[14,3],[13.5,1.5],[13,0.5],[12,-0.5],[11.5,-1],[11,-1],[8.5,-1],[7,-0.5],[6.5,-0.5],[5,1],[4.5,2],[4,3],[4,3.5],[4.5,3.5],[5.5,3],[7,2],[8,1],[9.5,0],[10.5,0],[11,-0.5],[12,-0.5],[12.5,0],[13,0.5],[13.5,2],[14,2.5],[14,5.5],[14.5,8],[14.5,10],[14.5,12.5],[15,15],[15,15.5],[15.5,18],[16,19],[16.5,19.5],[17,19.5],[17.5,19],[18.5,18.5],[19.5,17.5],[20.5,16],[21,14],[21.5,12.5],[22,11.5],[22.5,10.5],[23,9],[23.5,6.5],[23.5,4.5],[24,3],[24,1.5],[24,0],[24,-0.5],[24,-1],[24,-0.5],[24,0.5],[24,2.5],[24,4.5],[24,5.5],[24,9],[23.5,12],[23.5,14],[23.5,15],[23.5,17.5],[23.5,18.5],[23.5,19],[23.5,19.5],[23.5,19],[23.5,18.5],[23.5,17.5],[23.5,16.5],[23.5,14.5],[24,13],[24.5,11],[24.5,10],[25,9],[25.5,7],[26,6],[26,5],[27,3.5],[28,2.5],[28.5,1.5],[29,1.5],[30,1.5],[30.5,2.5],[31,3],[32,5.5],[32.5,6.5],[32.5,7.5],[32.5,8.5],[33,9.5],[34,13.5],[34.5,15.5],[35,16.5],[36.5,17],[37,17],[38.5,16.5],[39,15.5],[40,14],[40.5,13],[41.5,11.5],[42,9.5],[43,8],[44,5.5],[44.5,4.5],[45,3.5],[45.5,2],[46.5,0.5],[47.5,-0.5],[49,-1.5],[50,-1.5],[51,-2],[52,-1.5],[53,-1.5],[54,-0.5],[54.5,0],[54.5,0.5],[55,2],[55.5,3.5],[56,5],[56,7],[56,9],[56,10.5],[55.5,13],[55,15.5],[54.5,16.5],[54,17.5],[52.5,19],[51.5,20.5],[50.5,21.5],[49.5,22],[49,22],[48,21.5],[47,20.5],[46.5,19.5],[45,17]],"data":{"class":[]},"id":"b814aa181094be17dd3c6fdac1477b42f","position":[556.5,402]},{"points":[[0,0],[-0.5,-0.5],[-1.5,-1],[-2,-1.5],[-2.5,-1.5],[-3,-1.5],[-3.5,-1],[-4.5,-0.5],[-5.5,0.5],[-6,1],[-6.5,2],[-7.5,4],[-8,6],[-8.5,8],[-9,10],[-9,11],[-8.5,12],[-8.5,14],[-8,14.5],[-7.5,15],[-7,16],[-6,16.5],[-5,17],[-3.5,17],[-3,17],[-2.5,17],[-1.5,17.5],[-0.5,17.5],[0,17.5],[1,18.5],[1.5,19],[2,20],[2,21],[2.5,21.5],[2,23],[1.5,24.5],[1,26.5],[0,28],[-0.5,29],[-1,29.5],[-1,30],[-1.5,30.5],[-2.5,31.5],[-3,32],[-3.5,32],[-4,32],[-4.5,32],[-5,32],[-5,31.5],[-5,30.5],[-4.5,30],[-4,29],[-3.5,28.5],[-2.5,27.5],[-2.5,26.5],[-1.5,26],[-1,25],[-0.5,24.5],[0,24],[0.5,23],[1.5,21.5],[2.5,19.5],[3.5,17.5],[4.5,15.5],[5.5,13],[6.5,10.5],[7.5,7.5],[9,4],[10,1.5],[11,-1.5],[11.5,-3],[12,-4.5],[12.5,-7],[13.5,-9],[14,-11],[14,-12],[14.5,-12.5],[14.5,-13],[14.5,-12.5],[14.5,-11],[14.5,-9.5],[14,-7.5],[14,-5],[14,-2],[14,1],[13.5,4.5],[12.5,8.5],[11.5,12.5],[11.5,14],[11,16],[10.5,19.5],[10.5,22.5],[11,25],[11,26.5],[12,27.5],[13,28],[14,28],[15,27.5],[16,27],[16.5,26.5],[17.5,25],[18,24],[18.5,23.5],[19,21.5],[19.5,20.5],[20,19.5],[20.5,17],[21.5,15],[22,12.5],[22,11.5],[22.5,10.5],[22.5,9],[23,7.5],[23,6.5],[23.5,5.5],[23.5,5],[23.5,6],[23.5,7],[23.5,9],[23.5,9.5],[23.5,11],[23,13],[23,15.5],[23,17],[23,18],[23.5,20],[23.5,21.5],[23.5,22.5],[24,24.5],[24.5,26.5],[25,28],[25.5,28.5],[26,29],[26.5,29.5],[27.5,29.5],[28,30],[29,29.5],[29.5,29.5],[30,29],[30.5,29],[31.5,28.5],[32.5,27],[34,25],[35,23],[36,21.5],[36.5,19],[37,17]],"data":{"class":[]},"id":"b0f9155670b2f9f5717d46dfd31402643","position":[659.5,391]},{"points":[[0,0],[1,0],[2,0],[3.5,-0.5],[5.5,-0.5],[7,-0.5],[8,-0.5],[9,-0.5],[10.5,-1],[13,-1],[14.5,-1],[15.5,-1],[18.5,-1.5],[22,-1.5],[25.5,-1.5],[28.5,-1.5],[31,-2],[33.5,-2],[35,-2],[36.5,-2],[37,-2.5],[37.5,-2.5],[38,-2.5],[38.5,-2.5],[38.5,-3]],"data":{"class":[]},"id":"bfc46b6086d265096c5e1156646dc30a2","position":[662,385]},{"points":[[0,0],[0.5,-0.5],[1,-1],[2,-1.5],[3,-1.5],[3.5,-1.5],[4,-1.5],[5,-2],[6,-2.5],[6.5,-2.5],[7,-2.5],[7.5,-2.5],[8,-2.5],[8.5,-2],[9,-2],[10,-1.5],[10.5,-1.5],[10.5,-1],[11,-0.5],[11.5,0],[12,0.5],[12,1],[12.5,2],[12.5,2.5],[12.5,3.5],[12.5,5],[12.5,7],[12,9],[11.5,11.5],[11.5,13],[11,14],[10.5,16.5],[9.5,18.5],[8.5,20],[8,21],[7.5,22],[6,23.5],[5.5,24],[4.5,24.5],[3.5,26],[2,26.5],[1,27],[0.5,27],[-0.5,27],[-1.5,26.5],[-2.5,26],[-3.5,25],[-4,24],[-4.5,22.5],[-4.5,21],[-4.5,19],[-4,17],[-4,16],[-3.5,15],[-2.5,13.5],[-1.5,12],[-0.5,10],[0.5,9.5],[1,9],[1.5,9],[2.5,9],[4,8.5],[4.5,8.5],[5.5,9],[7,9.5],[7.5,10],[8.5,10.5],[9.5,12.5],[10,13.5],[10.5,14.5],[11.5,16.5],[12.5,19],[13.5,21],[14,22.5],[15,24.5],[15.5,25],[16,25.5],[16.5,26.5],[17.5,27],[18,27],[19,27],[19.5,26.5],[20,26.5],[21,25.5],[21.5,24.5],[22,23],[23,21.5],[23.5,19.5],[24,18],[24,16.5],[24,15.5],[24.5,14.5],[24.5,13],[25,11],[25,9.5],[25.5,9],[25.5,8],[25.5,7.5],[25.5,6.5],[25.5,8],[25.5,9.5],[26,11],[26,12],[26,13.5],[26,15.5],[26.5,18],[26.5,19],[27,20],[27,21],[27,21.5],[27.5,22.5],[28,23],[28.5,23.5],[29,24],[30,24],[31,24],[31.5,24],[32,23.5],[32.5,22.5],[33.5,21.5],[34,20],[35,18.5],[35,17],[35.5,15],[36,12],[36.5,9.5],[36.5,9],[36.5,8.5],[36.5,6.5],[37,5],[37,4],[37,5],[37.5,6],[37.5,7],[37.5,8],[37.5,9],[38,11.5],[38,12.5],[38.5,14],[39,16.5],[39.5,18.5],[40,20],[41,21.5],[41.5,22.5],[43,23],[44,23],[44.5,23],[45,23],[46,22.5],[46.5,22],[47.5,21],[48.5,20.5],[49,20],[50,18.5],[51,16.5],[51.5,14.5],[52,12.5],[52,11.5],[52.5,11],[52.5,9],[52.5,8],[52.5,7],[52,6],[52,5],[51,3],[50.5,1],[49.5,0],[48.5,-1],[48,-1.5],[47,-1.5],[46.5,-0.5],[46,0],[45.5,1.5],[45.5,2],[45,3],[45,4],[45,5],[45.5,6],[46,7.5],[47,9],[47.5,10],[49,11],[50,11.5],[51.5,11.5],[52.5,11.5],[53,11.5],[54.5,11],[55.5,11],[56,11],[57.5,10.5],[58.5,10],[59.5,9],[60,8.5],[60.5,8],[61,7],[61.5,6.5],[62,6],[61.5,5.5]],"data":{"class":[]},"id":"b7820078ad1e109a4aca18ba03e9d02e3","position":[700.5,396]},{"points":[[0,0],[0,-0.5],[-0.5,-1],[-0.5,-1.5],[0,-0.5],[0,0],[0.5,2],[1,4.5],[1,7],[1,10.5],[1,12],[1,14],[1,17.5],[1.5,21],[1.5,24.5],[1.5,26.5],[1.5,28.5],[1.5,30.5],[1.5,33],[2,37],[2,41.5],[2,45],[2.5,48],[3,50.5],[3,51.5],[3,52],[3,52.5],[3,53.5],[3.5,54],[3.5,54.5],[4,54],[4.5,53.5],[5,52.5],[5.5,51],[6,49],[6,46.5],[6.5,45.5],[6.5,44.5],[7,42],[8,40.5],[8.5,38.5],[9,37.5],[9,37],[9.5,36],[10,36],[10.5,35.5],[11,34.5],[11.5,34.5],[12,33.5],[12.5,33.5],[13,34],[14,34],[14.5,34.5],[15.5,35.5],[16,36],[16,37],[17,39],[17.5,40.5],[17.5,41],[18,42],[18,44.5],[17.5,45.5],[17.5,46.5],[17,49],[16.5,51],[16,52.5],[15.5,53.5],[15,54.5],[14,56],[13,57],[12,58],[11,58.5],[10.5,59],[9.5,59],[8.5,59],[7,59],[4,57],[2.5,56],[1.5,55],[1,54.5],[0,53],[0,52.5],[0,51.5],[0,50.5],[0.5,50],[1.5,49.5],[2,49.5]],"data":{"class":[]},"id":"bedcfd10313a6afecdf6ab77a357754b4","position":[766.5,366]}],"groupLines":[],"stickyLines":[{"points":[[0,0],[1.5,5],[2,7.5],[2,9],[2,10.5],[2.5,12],[2.5,13.5],[2.5,15],[2.5,16.5],[2.5,18],[2.5,20],[2.5,21.5],[2.5,23],[2.5,25],[2,27],[2,29],[2,30.5],[2,32.5],[2,34],[1.5,36],[1.5,38],[1.5,44.5],[1.5,47.5],[1.5,50],[1.5,53],[1.5,55.5],[1.5,58.5],[1.5,61.5],[1.5,64.5],[1.5,67.5],[1.5,70.5],[1.5,73.5],[1.5,76.5],[1.5,79.5],[1.5,82.5],[1.5,85.5],[1.5,88.5],[1.5,91.5],[2,95],[2,100.5],[2,106.5],[2,112.5],[2,119],[2,125],[2.5,131.5],[2.5,134.5],[2.5,138],[2.5,141],[2.5,144],[3,149.5],[3,152.5],[3,155],[3.5,160.5],[4,165],[4,167],[4,169.5],[4.5,171.5],[4.5,173.5],[5,178],[5,180],[5,182],[5,184],[5,186],[5,190.5],[5,192.5],[5,195],[5,199.5],[5,201.5],[5,203.5],[5,205.5],[5,207.5],[5,209.5],[5,211.5],[4.5,215.5],[4.5,217.5],[4.5,219],[4.5,220.5],[4.5,222.5],[4.5,224],[4.5,225.5],[4.5,228],[4.5,229],[4.5,230.5],[4.5,232.5],[4.5,234.5],[4.5,235.5],[4.5,236.5],[4.5,237.5],[4,238.5],[4,239],[4,240],[4,240.5],[4.5,241.5]],"linesAttached":[],"placeHolder":[{"id":"left","data":{},"lines":[]},{"id":"right","data":{},"lines":[]},{"id":"top","data":{},"lines":[]},{"id":"bottom","data":{},"lines":[]},{"id":"middle","data":{},"lines":[]}],"id":"b3f0f2126ae6c25432125fa9db0b22867","position":[160,228],"textPosition":{"where":"right","position":[10,50]}}],"menuItems":[],"lettres":[]}

  const rootReducer = (state = initialState, action) => {
    // console.log(action.type)
    // console.log(JSON.stringify(state))
    switch (action.type) {
      
      //Add line to placeholder
      case 'ADD_LINE_TO_STICKY_GROUP':
        var id = action.data.idGuide;
        var where = action.data.where;
        var data = action.data.data;
        var index = state.stickyLines.indexOf(state.stickyLines.find(x => x.id == id))
        if (index > -1){

          var indexLine = state.stickyLines[index]['placeHolder'].indexOf(state.stickyLines[index]['placeHolder'].find(x => x.id == where))
          if (indexLine > -1){

          // console.log(index, indexLine)
            state = update(state, { 
              stickyLines: {
                [index] : {
                  placeHolder: {
                    [indexLine]: { 
                      lines: {$push: data}
                    }
                  }
                  
                }
              }
            })
          }
        }
        
        return state;


      case 'ADD_SKETCH_LINE':
        // console.log(state.sketchLines)
        return { 
          ...state, 
          sketchLines: [ ...state.sketchLines, action.data] 
        };
        case 'CREATE_STICKY_LINES':
            return { 
              ...state, 
              stickyLines: [ ...state.stickyLines, action.data] 
            };
      case 'CREATE_GROUP_LINES':
        return { 
          ...state, 
          groupLines: [ ...state.groupLines, action.data] 
        };
      
      
        case 'SHOULD_OPEN_MENU':
        if (action.data.shouldOpen == true){
          return { 
            ...state, 
            menuItems: [ ...state.menuItems, action.data] 
          };
        }
        else if (action.data.shouldOpen == false){
          var index = state.menuItems.indexOf(state.menuItems.find(x => x.id == action.data.id))
          if (index > -1){
            state = update(state, { 
              menuItems: {$splice: [[index, 1]]}
            })
          }
          return state;
        }
         
      case 'ADD_LINES_CLASS':
        var idsLine = action.data.idLines;
       
        idsLine.forEach((id)=>{
          var index = state.sketchLines.indexOf(state.sketchLines.find(x => x.id == id))
          if (index > -1){
            // console.log(state.sketchLines[index]['data']['class'])
            state = update(state, { 
              sketchLines: {
                [index] : {
                  data: {
                    class: {$push: action.data.class},
                  }
                }
              }
            })
          }
        })
        return state;


        case 'ADD_LINES_TO_STICKY':
          var id = action.data.id;
          console.log(action.data)
          // 'data': {'linesAttached': this.objectIn}, 
          // idsLine.forEach((id)=>{
            var index = state.stickyLines.indexOf(state.stickyLines.find(x => x.id == id))
            // console.log(index)
            if (index > -1){
              console.log(action.data, state.stickyLines[index])
              // console.log(state.sketchLines[index]['data']['class'])
              state = update(state, { 
                stickyLines: {
                  [index] : {
                    data: {
                      linesAttached: {$push: action.data.idLines},
                    }
                  }
                }
              })
            }
          
          return state;

        
        // console.log(action.data)

      case 'REMOVE_SKETCH_LINES':
          var idsToDelete = action.data;
          idsToDelete.forEach((idToDelete)=>{
            var index = state.sketchLines.indexOf(state.sketchLines.find(x => x.id == idToDelete))
            if (index > -1){
              state = update(state, { 
                sketchLines: {$splice: [[index, 1]]}
              })
            }
          })
          return state;

        
        
      default:
        return state;
    }
  }
    

  export default combineReducers({
    rootReducer : undoable(rootReducer)
  })

  